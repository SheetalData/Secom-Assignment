from scipy.stats import shapiro
def get_shapiro_for_col(df, col_name):
  return shapiro(df[df[col_name].notnull()][col_name]) 
  shapiro_test_value_dict = dict()
  shapiro_p_value_dict = dict()
for col in df1.columns:
  test_value, p_value = get_shapiro_for_col(df1, col)
  print(col, test_value, p_value)
   shapiro_test_value_dict[col] = test_value
   shapiro_p_value_dict[col] = p_value
   Shapiro=pd.DataFrame(shapiro_p_value_dict,index=["Shapiro"])
Shapiro.columns[Shapiro.iloc[0].argmax()]
sum(Shapiro.iloc[0]<0.05)
sum(Shapiro.iloc[0]>0.05)
